# 上行短信验证安全性分析 #

以[http://www.miaodiyun.com/doc/service_MO.html](http://www.miaodiyun.com/doc/service_MO.html "秒嘀科技")的上行短信请求实例为例：

    POST /配置的回调地址
    Accept:application/json
    Content-Type:application/json;charset=utf-8
    
    {
    "MOPort": "6985",
    "phone": "138xxxxxxxx",
    "content": "content",
    "MOTime": "2015-06-29 19:23:26",
    "timestamp": "1435897700379",
    "sig": "23fbdb3d590cf755afcfe4b197099554"
    }

请求方式：POST

支持格式：JSON

请求参数说明：

- **MOPort** 分配给开发者的上行短信端口
- **phone**  上行手机号码
- **content**  上行短信内容
- **MOTime**  上行短信时间
- **timestamp**  时间戳。当前系统时间（24小时制），格式"yyyyMMddHHmmss"。时间戳有效时间为5分钟
- **sig**  签名。MD5(ACCOUNT SID + AUTH TOKEN + timestamp)。共32位（小写）


相对上行短信，下行短信被攻击者直接获取对验证结果无直接影响。

下行短信的请求参数里包括时间戳与签名。时间戳与用户标识、用户身份令牌组合，经过MD5算法生成哈希签名发送给接收方。时间戳精确到秒，且5分钟有效。

当中间人拦截到此上行短信，在短时间内也无法进行哈希碰撞产生伪造的签名。从而无法伪造上行短信。因此上行短信在伪造方面是安全的。

但上行短信同下行短信一样，可能受到补卡攻击或克隆攻击。如果攻击者办一张和受害者相同的手机号（卡），就可以达到克隆的目的——接受受害者的验证码，以受害者的身份进行上行短信验证。